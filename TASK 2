--- TASK 2
SELECT 
    -- First we select the columns that want to see
    DATE_TRUNC(transaction_date, MONTH) AS mes, -- Analice the transaction date by the month
    customer_id,
    AVG(CAST(amount AS NUMERIC)) AS promedio_gastado -- Change the column amount to a numeric type and see the average of it
FROM `myproject-487315.myproyect.transacciones_bancarias` 
-- We group an order the results by the month and customers
GROUP BY customer_id, mes 
ORDER BY customer_id, mes
